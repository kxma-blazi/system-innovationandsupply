{
  "name": "LineBot-SYS2//Success",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "=={{ $json.text }}",
        "options": {
          "systemMessage": "You are a deterministic Ticket Parsing Engine.\n\nYou extract structured ticket data from raw user messages.\n\nYou MUST follow every rule strictly.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nABSOLUTE OUTPUT RULES\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n1. Output ONLY valid JSON.\n2. Do NOT wrap in markdown.\n3. Do NOT explain anything.\n4. Do NOT add extra text.\n5. Do NOT add extra keys.\n6. Do NOT rename keys.\n7. Do NOT nest objects.\n8. Do NOT calculate or infer values.\n9. Do NOT translate.\n10. Do NOT modify formats.\n11. If value is missing ‚Üí return null.\n12. If value is \"-\" ‚Üí return null.\n13. JSON must be flat.\n14. No trailing commas.\n\nIf no fields are found, still return full JSON with all keys set to null.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nREQUIRED OUTPUT FORMAT\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n{\n\"ticket_no\": string | null,\n\"severity\": \"NSA1\" | \"NSA2\" | \"NSA3\" | \"NSA4\" | null,\n\"fault_date\": string | null,\n\"expected_date\": string | null,\n\"owner\": string | null,\n\"go_time\": string | null,\n\"start_time\": string | null,\n\"done_time\": string | null,\n\"status\": string | null\n}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nEXTRACTION RULES\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nticket_no:\n- Extract ONLY if it matches regex: TT\\d+\n- Return full match only.\n- Ignore \"Ticket: -\" or empty values.\n- If not found ‚Üí null.\n\nseverity:\n- Must match exactly: NSA1 | NSA2 | NSA3 | NSA4\n- Case sensitive.\n- If not found ‚Üí null.\n\nfault_date:\n- Extract full datetime string after:\n  \"FaultDate :\" OR\n  \"Fault :\" OR\n  \"FaultDate:\" OR\n  \"Fault:\"\n- Return exact string after colon.\n- If value is \"-\" ‚Üí null.\n- If not found ‚Üí null.\n\nexpected_date:\n- Extract full datetime string after:\n  \"Expected :\" OR\n  \"ExpectedDate :\" OR\n  \"Expected:\" OR\n  \"ExpectedDate:\"\n- Return exact string after colon.\n- If value is \"-\" ‚Üí null.\n- If not found ‚Üí null.\n\nowner:\n- Extract exact value after:\n  \"OpenTicketName :\" OR\n  \"OwnerTeam :\" OR\n  \"Owner :\" OR\n  \"‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏á‡∏≤‡∏ô :\"\n- Return exact string after colon.\n- If value is \"-\" ‚Üí null.\n- If not found ‚Üí null.\n\ngo_time:\n- Extract using regex: !Go#(\\d{2}:\\d{2})\n- Return only HH:mm\n- If not found ‚Üí null.\n\nstart_time:\n- Extract using regex: !Star#(\\d{2}:\\d{2})\n- Return only HH:mm\n- If not found ‚Üí null.\n\ndone_time:\n- Extract using regex: !Done#(\\d{2}:\\d{2})\n- Return only HH:mm\n- If not found ‚Üí null.\n\nstatus:\n- Extract exact value after:\n  \"Status :\" OR\n  \"‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ :\"\n- Return exact string after colon.\n- If value is \"-\" ‚Üí null.\n- If not found ‚Üí null.\n\nticket_no:\nMatch regex /TT\\d+/i\n\nseverity:\nMatch /NSA[1-4]/i\nReturn uppercase (NSA1‚ÄìNSA4)\n\nfault_date:\nMatch /FaultDate\\s*:\\s*(.+)/i\n\nowner:\nMatch /OpenTicketName\\s*:\\s*(.+)/i OR /OwnerTeam\\s*:\\s*(.+)/i\n\nstatus:\nMatch /Status\\s*:\\s*(.+)/i\n\ngo_time:\nMatch /!Go#(\\d{2}:\\d{2})/i\n\nstart_time:\nMatch /!Star#(\\d{2}:\\d{2})/i\n\ndone_time:\nMatch /!Done#(\\d{2}:\\d{2})/i\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nFINAL INSTRUCTION\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nReturn JSON only.\nAlways include all keys.\nNever omit keys.\nNever hallucinate values.",
          "returnIntermediateSteps": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        432,
        -128
      ],
      "id": "d38d7771-8b0a-4272-8b7d-6d0dd688b51c",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Line Messaging Trigger').item.json.source.userId }}",
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        528,
        96
      ],
      "id": "731b5816-5d01-4daf-9de1-c05428ae2102",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "events": [
          "message"
        ]
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessagingTrigger",
      "typeVersion": 1,
      "position": [
        -208,
        -128
      ],
      "id": "ce766736-4fa2-4477-9a76-e8647acb58f8",
      "name": "Line Messaging Trigger",
      "webhookId": "846ec9c9-c682-4efb-9811-5db936748e47",
      "credentials": {
        "lineMessagingApi": {
          "id": "aJgZGG757I8itMKK",
          "name": "Bot-SYS2"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "modelName": "=models/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        432,
        64
      ],
      "id": "685a5a20-e53d-4d52-9790-574df94b7597",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "WuOAgQNbBp0HiPws",
          "name": "Google Gemini(PaLM) - UPDATE23-02-2026"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return items.map(item => {\n  let data = item.json;\n\n  // ‡∏ñ‡πâ‡∏≤ AI ‡∏™‡πà‡∏á‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô string ‡πÉ‡∏´‡πâ parse\n  if (typeof data === \"string\") {\n    data = JSON.parse(data);\n  }\n\n  // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô key ‡∏ä‡∏∑‡πà‡∏≠ output\n  if (typeof data.output === \"string\") {\n    data = JSON.parse(data.output);\n  }\n\n  return {\n    json: data\n  };\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        128,
        -208
      ],
      "id": "0328b06f-ad2f-4714-8789-ea56a8d27edf",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "content": "1Ô∏è‚É£ Line Messaging Trigger\n‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å LINE OA\ntext\nreplyToken\nuserId",
        "height": 176,
        "width": 214
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -960,
        -528
      ],
      "typeVersion": 1,
      "id": "8d022a22-0082-4e63-a751-c71f5583b86c",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "3Ô∏è‚É£ AI Agent\n‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ ‚Üí JSON ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô\nField ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ:\nticket_no\n\nseverity\nfault_date\nexpected_date\nowner\ngo_time\nstart_time\ndone_time\nstatus",
        "height": 272,
        "width": 336
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -560,
        -528
      ],
      "typeVersion": 1,
      "id": "51ff1190-48b0-4967-8161-ade6ba617866",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "5Ô∏è‚É£ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA\nSeverity   |    SLA\nNSA1\t |  4 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á\nNSA2\t |  8 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á\nNSA3\t | 14 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á\nNSA4\t | 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á\n\nExpected Date = fault_date + SLA\nTimeZone: Asia/Bangkok",
        "height": 240,
        "width": 256
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -48,
        -528
      ],
      "typeVersion": 1,
      "id": "9d4c7516-c7a5-4af4-981a-a5fe9a5b6b3f",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "7Ô∏è‚É£ ‡∏™‡∏£‡πâ‡∏≤‡∏á Status ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n‡∏°‡∏µ done_time ‚Üí Done\n‡∏°‡∏µ start_time ‚Üí In Progress\n‡∏°‡∏µ go_time ‚Üí On Site\n‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏¢ ‚Üí Open",
        "height": 240,
        "width": 208
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        464,
        -528
      ],
      "typeVersion": 1,
      "id": "a6c01ad9-f087-4f64-8bc3-4c36dcfc868b",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "8Ô∏è‚É£ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö LINE\n\n‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:\nüìå Ticket: TT12345\n‚ö° Severity: üö® NSA1\nüìÖ Fault: 28/12/2025 23:45\nüìÜ Expected: 29/12/2025 03:45\nüöó Go: -\nüîß Start: -\n‚úÖ Done: -\nüìç Status: Open",
        "height": 240,
        "width": 256
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        672,
        -528
      ],
      "typeVersion": 1,
      "id": "9119ef54-9878-407d-953f-13b04d3fea85",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "IF Node\n‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:\n‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\n‡πÄ‡∏ä‡πà‡∏ô:\nticket_no ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á\nstatus ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á\n‡∏ñ‡πâ‡∏≤‡∏ú‡πà‡∏≤‡∏ô ‚Üí ‡∏™‡πà‡∏á LINE\n‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô ‚Üí ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error",
        "height": 176
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1248,
        -528
      ],
      "typeVersion": 1,
      "id": "4cebc26e-b40e-4205-8682-109ec3b8fe61",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "content": "Line Messaging (Send)\n‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:\n‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á user ‡∏ú‡πà‡∏≤‡∏ô LINE\n‡πÉ‡∏ä‡πâ:\nuserId ‡∏à‡∏≤‡∏Å Trigger\nmessage text ‡∏à‡∏≤‡∏Å Code node ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤",
        "height": 144,
        "width": 352
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1488,
        -496
      ],
      "typeVersion": 1,
      "id": "8173b995-c166-4ba1-9b1f-424f43a40f37",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nüìå LINE Ticket Automation Workflow\n1Ô∏è‚É£ Line Messaging Trigger\n‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å LINE OA\ntext\nuserId\nreplyToken\n‚¨á\n\n2Ô∏è‚É£ Detect Mode (Code)\n‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏∞‡πÑ‡∏£\nMode ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ:\nupdate_ticket\nquery_ticket\ntoday_summary\nquery_site\nunknown\n\n‚¨á\n\n3Ô∏è‚É£ IF ‚Äì ‡πÅ‡∏¢‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á\n‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö mode\n‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô query ‚Üí ‡πÑ‡∏õ AI Agent\n‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô update_ticket ‚Üí ‡πÑ‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á/‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Ticket\n‚¨á\n\n4Ô∏è‚É£ AI Agent\n‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°\n‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô\nField ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ:\nticket_no\nseverity\nfault_date\nexpected_date\nowner\ngo_time\nstart_time\ndone_time\nstatus\n‚¨á\n\n5Ô∏è‚É£ Parse JSON\n‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ JSON ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\nParse ‡πÑ‡∏î‡πâ\nKey ‡∏Ñ‡∏£‡∏ö\n‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö ‚Üí Error\n‚¨á\n\n6Ô∏è‚É£ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA (Edit Fields)\nSeverity ‚Üí SLA ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á\nNSA1 = 4 ‡∏ä‡∏°\nNSA2 = 8 ‡∏ä‡∏°\nNSA3 = 14 ‡∏ä‡∏°\nNSA4 = 24 ‡∏ä‡∏°\nExpected Date = fault_date + SLA\nTimeZone: Asia/Bangkok\n\n‚¨á\n\n7Ô∏è‚É£ Append Google Sheet\n‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Ticket ‡∏•‡∏á Google Sheet\n‚¨á\n\n8Ô∏è‚É£ Normalize Ticket Data\n‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\n‡∏™‡∏£‡πâ‡∏≤‡∏á Status ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\nStatus Logic:\n‡∏°‡∏µ done_time ‚Üí Done\n‡∏°‡∏µ start_time ‚Üí In Progress\n‡∏°‡∏µ go_time ‚Üí On Site\n‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏¢ ‚Üí Open\n\n‚¨á\n\n9Ô∏è‚É£ IF ‡∏ï‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á\n‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ ticket_no ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á\n‡∏ñ‡πâ‡∏≤‡∏ú‡πà‡∏≤‡∏ô ‚Üí ‡∏™‡πà‡∏á LINE\n‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô ‚Üí ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error\n\n‚¨á\n\nüîü Line Messaging (Send)\n‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ\n\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n‚úÖ Result\nUser ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‚Üí ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á Ticket ‚Üí ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‚Üí ‡∏™‡πà‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏•‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ",
        "height": 1696,
        "width": 832
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        928,
        -2224
      ],
      "typeVersion": 1,
      "id": "0fad679d-9525-44f8-bfc8-48bbddd4161c",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "content": "Line Messaging ‡πÉ‡∏ä‡πâ Webhook Production \n‡πÑ‡∏î‡πâ‡πÄ‡πÄ‡∏•‡πâ‡∏ß (‡∏ö‡∏≠‡∏ó‡∏ó‡∏≥‡∏á‡∏≤‡∏ô 24hrs)",
        "height": 80,
        "width": 304
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1232,
        48
      ],
      "typeVersion": 1,
      "id": "61ca3f64-3fe9-40cb-86ed-0437349aa843",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1sjN3thWlP_a1qGjft7MuLglHbT4P9RSx0QGgqKHiT5Y",
          "mode": "list",
          "cachedResultName": "Real‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏Ç‡∏≠‡∏á LAB ‡∏á‡∏≤‡∏ô‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö NodeB2025",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sjN3thWlP_a1qGjft7MuLglHbT4P9RSx0QGgqKHiT5Y/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1430076532,
          "mode": "list",
          "cachedResultName": "LABJob_System December 2025",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sjN3thWlP_a1qGjft7MuLglHbT4P9RSx0QGgqKHiT5Y/edit#gid=1430076532"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Region": "=",
            "TT No. / PW No.": "=",
            "Source": "=",
            "TT : ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°": "=",
            " Destination": "=",
            "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà Ticket ‡πÄ‡∏õ‡∏¥‡∏î": "=",
            "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î Ticket": "=",
            "‡∏ó‡∏µ‡∏°": "=",
            "‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡∏°\n(‡∏à.‡∏ô.‡∏Ñ‡∏ô)": "=",
            "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á": "=",
            "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á": "=",
            "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°": "=",
            "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°": "=",
            "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞": "=",
            "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞": "=",
            "‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞": "=",
            "SLA (OK/NOK)": "=",
            "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏": "=",
            "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà": "=",
            "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏∏‡∏î, ‡πÄ‡∏•‡∏¥‡∏Å‡∏ã‡πà‡∏≠‡∏°": "=",
            "‡πÄ‡∏ß‡∏•‡∏≤": "=",
            "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏™‡∏µ‡∏¢": "=",
            "‡∏Ç‡∏≠‡∏á‡∏î‡∏µ/‡πÄ‡∏•‡∏ÇSAP": "=",
            "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ Over SLA": "=",
            "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢/‡πÄ‡∏•‡∏ÇSAP": "=",
            "CM report": "=",
            "Admin Name": "=",
            "Admin Verify Date": "="
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Region",
              "displayName": "Region",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TT No. / PW No.",
              "displayName": "TT No. / PW No.",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Serverity",
              "displayName": "Serverity",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°.)",
              "displayName": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°.)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "SLA/T",
              "displayName": "SLA/T",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "TT : ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°",
              "displayName": "TT : ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Source",
              "displayName": "Source",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": " Destination",
              "displayName": " Destination",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà Ticket ‡πÄ‡∏õ‡∏¥‡∏î",
              "displayName": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà Ticket ‡πÄ‡∏õ‡∏¥‡∏î",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î Ticket",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î Ticket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ Ticket ‡πÄ‡∏õ‡∏¥‡∏î",
              "displayName": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ Ticket ‡πÄ‡∏õ‡∏¥‡∏î",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "‡∏ä‡∏∑‡πà‡∏≠",
              "displayName": "‡∏ä‡∏∑‡πà‡∏≠",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "‡∏ó‡∏µ‡∏°",
              "displayName": "‡∏ó‡∏µ‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡∏°\n(‡∏à.‡∏ô.‡∏Ñ‡∏ô)",
              "displayName": "‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡∏°\n(‡∏à.‡∏ô.‡∏Ñ‡∏ô)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á",
              "displayName": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á",
              "displayName": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°",
              "displayName": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°",
              "displayName": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
              "displayName": "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
              "displayName": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à",
              "displayName": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Total Recovery Time (hh:mm)",
              "displayName": "Total Recovery Time (hh:mm)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SLA (OK/NOK)",
              "displayName": "SLA (OK/NOK)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏",
              "displayName": "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà",
              "displayName": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏∏‡∏î, ‡πÄ‡∏•‡∏¥‡∏Å‡∏ã‡πà‡∏≠‡∏°",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏∏‡∏î, ‡πÄ‡∏•‡∏¥‡∏Å‡∏ã‡πà‡∏≠‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏™‡∏µ‡∏¢",
              "displayName": "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏™‡∏µ‡∏¢",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ Over SLA",
              "displayName": "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ Over SLA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏Ç‡∏≠‡∏á‡∏î‡∏µ/‡πÄ‡∏•‡∏ÇSAP",
              "displayName": "‡∏Ç‡∏≠‡∏á‡∏î‡∏µ/‡πÄ‡∏•‡∏ÇSAP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢/‡πÄ‡∏•‡∏ÇSAP",
              "displayName": "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢/‡πÄ‡∏•‡∏ÇSAP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TT No. / PW No.ServeritySource",
              "displayName": "TT No. / PW No.ServeritySource",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CM report",
              "displayName": "CM report",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Admin Name",
              "displayName": "Admin Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Admin Verify Date",
              "displayName": "Admin Verify Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        928,
        304
      ],
      "id": "d1bd8e42-505e-4e61-a3b5-5586d08ec3c3",
      "name": "Tools Sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "WoHKjUMsnt7MqePX",
          "name": "Google Sheets account - UPDATE23-02-2026"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const text = ($json.message?.text || '').toLowerCase().trim();\n\nlet mode = \"unknown\";\n\n// ‡∏ï‡∏£‡∏ß‡∏à TT number\nif (/tt\\d+/i.test(text)) {\n  if (text.includes(\"‡πÄ‡∏ä‡πá‡∏Ñ\") || text.includes(\"check\")) {\n    mode = \"query_ticket\";\n  } else {\n    mode = \"update_ticket\";\n  }\n}\n\n// ‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ\nelse if (text.includes(\"‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ\")) {\n  mode = \"today_summary\";\n}\n\n// query site\nelse if (text.includes(\"site\")) {\n  mode = \"query_site\";\n}\n\n// ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÅ‡∏ö‡∏ö merge ‡∏Å‡∏±‡∏ö input ‡πÄ‡∏î‡∏¥‡∏° (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö production)\nreturn {\n  ...$json,\n  text,\n  mode,\n  replyToken: $json.replyToken,\n  userId: $json.source?.userId\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -32,
        -128
      ],
      "id": "42a76e62-0f1f-40b4-8572-8091bdb039a0",
      "name": "Detect Mode"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "f72d226e-bd76-4673-9541-7541e5d9de3c",
              "leftValue": "={{$json.mode}}",
              "rightValue": "=query_ticket",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "6ed8fff0-82fc-4aa2-94a8-f2d10fd80543",
              "leftValue": "={{$json.mode}}",
              "rightValue": "=today_summary",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            },
            {
              "id": "bce04745-a77c-46b2-821f-90ea49f098d4",
              "leftValue": "={{$json.mode}}",
              "rightValue": "query_site",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        128,
        48
      ],
      "id": "da10125e-7268-414e-ba51-c96cb51c6f70",
      "name": "IF - Query Mode"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      ...$json,\n      userId: $items(\"Detect Mode\")[0].json.userId,\n      finalMessage:\n        $json.output ||\n        $json.response ||\n        $json.result ||\n        $json\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        736,
        -128
      ],
      "id": "a169b4a5-c8fb-48fd-afbc-a21deb7cf5db",
      "name": "Merge User"
    },
    {
      "parameters": {
        "jsCode": "function safeParse(raw) {\n  if (!raw) return null;\n\n  // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô object ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß\n  if (typeof raw === \"object\") return raw;\n\n  if (typeof raw !== \"string\") return null;\n\n  try {\n    const cleaned = raw\n      .replace(/^```json\\s*/i, '')\n      .replace(/```$/i, '')\n      .trim();\n\n    return JSON.parse(cleaned);\n  } catch (e) {\n    return null;\n  }\n}\n\nconst parsed = safeParse($json.finalMessage);\n\nconst requiredKeys = [\n  \"ticket_no\",\n  \"severity\",\n  \"fault_date\",\n  \"expected_date\",\n  \"owner\",\n  \"go_time\",\n  \"start_time\",\n  \"done_time\",\n  \"status\"\n];\n\nif (!parsed) {\n  return [{\n    json: {\n      error: true,\n      message: \"‚ùå AI ‡∏™‡πà‡∏á JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\"\n    }\n  }];\n}\n\n// ‡∏ï‡∏£‡∏ß‡∏à key ‡∏Ñ‡∏£‡∏ö‡πÑ‡∏´‡∏°\nfor (const key of requiredKeys) {\n  if (!(key in parsed)) {\n    return [{\n      json: {\n        error: true,\n        message: \"‚ùå JSON structure ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö\"\n      }\n    }];\n  }\n}\n\nreturn [{\n  json: parsed\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        912,
        -128
      ],
      "id": "02af16c9-4598-4776-b246-bb0e2fa6c82f",
      "name": "Parse Final JSON"
    },
    {
      "parameters": {
        "content": "",
        "height": 288,
        "width": 608,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        704,
        240
      ],
      "id": "0b47736b-3d6d-4f72-af6e-c3fb89916263",
      "name": "Sticky Note10"
    },
    {
      "parameters": {
        "content": "       ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤ node (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ)",
        "height": 80,
        "width": 326,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        992,
        448
      ],
      "id": "80b25c79-9092-4770-9395-a415c5ee4ad4",
      "name": "Sticky Note11"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1SpkGa57uRLhoSbc0edGla0QX0gD586tjmrUFJ_xIFgU",
          "mode": "list",
          "cachedResultName": "testdataLAB",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SpkGa57uRLhoSbc0edGla0QX0gD586tjmrUFJ_xIFgU/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2097907540,
          "mode": "list",
          "cachedResultName": "LABJob_System December 2025",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SpkGa57uRLhoSbc0edGla0QX0gD586tjmrUFJ_xIFgU/edit#gid=2097907540"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {},
          "matchingColumns": [],
          "schema": [
            {
              "id": "Job Service",
              "displayName": "Job Service",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤",
              "displayName": "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (Go)",
              "displayName": "‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á (Go)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏° (Start)",
              "displayName": "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏° (Start)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏° (Recovery)",
              "displayName": "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏° (Recovery)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Serial Number",
              "displayName": "Serial Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "locationDefine": {
            "values": {}
          }
        }
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        768,
        320
      ],
      "id": "e3289f0d-918a-486a-9dbb-2b2d7a19481b",
      "name": "Get row(s) in Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "WoHKjUMsnt7MqePX",
          "name": "Google Sheets account - UPDATE23-02-2026"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1SpkGa57uRLhoSbc0edGla0QX0gD586tjmrUFJ_xIFgU",
          "mode": "list",
          "cachedResultName": "testdataLAB",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SpkGa57uRLhoSbc0edGla0QX0gD586tjmrUFJ_xIFgU/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2097907540,
          "mode": "list",
          "cachedResultName": "LABJob_System December 2025",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SpkGa57uRLhoSbc0edGla0QX0gD586tjmrUFJ_xIFgU/edit#gid=2097907540"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {
            "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà Ticket ‡πÄ‡∏õ‡∏¥‡∏î": "={{$json.open_ticket_date}}",
            "Serverity": "={{$json.severity}}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Region",
              "displayName": "Region",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TT No.",
              "displayName": "TT No.",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Serverity",
              "displayName": "Serverity",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°.)",
              "displayName": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°.)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "SLA/T",
              "displayName": "SLA/T",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TT : ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°",
              "displayName": "TT : ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Source",
              "displayName": "Source",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": " Destination",
              "displayName": " Destination",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà Ticket ‡πÄ‡∏õ‡∏¥‡∏î",
              "displayName": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà Ticket ‡πÄ‡∏õ‡∏¥‡∏î",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î Ticket",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î Ticket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ Ticket ‡πÄ‡∏õ‡∏¥‡∏î",
              "displayName": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ Ticket ‡πÄ‡∏õ‡∏¥‡∏î",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ä‡∏∑‡πà‡∏≠",
              "displayName": "‡∏ä‡∏∑‡πà‡∏≠",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ó‡∏µ‡∏°",
              "displayName": "‡∏ó‡∏µ‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡∏°\n(‡∏à.‡∏ô.‡∏Ñ‡∏ô)",
              "displayName": "‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡∏°\n(‡∏à.‡∏ô.‡∏Ñ‡∏ô)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà",
              "displayName": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á",
              "displayName": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°",
              "displayName": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ã‡πà‡∏≠‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
              "displayName": "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à",
              "displayName": "‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Total Recovery Time (hh:mm)",
              "displayName": "Total Recovery Time (hh:mm)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "SLA (OK/NOK)",
              "displayName": "SLA (OK/NOK)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏",
              "displayName": "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏∏‡∏î, ‡πÄ‡∏•‡∏¥‡∏Å‡∏ã‡πà‡∏≠‡∏°",
              "displayName": "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏∏‡∏î, ‡πÄ‡∏•‡∏¥‡∏Å‡∏ã‡πà‡∏≠‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏™‡∏µ‡∏¢",
              "displayName": "‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏™‡∏µ‡∏¢",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ Over SLA",
              "displayName": "‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ Over SLA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏Ç‡∏≠‡∏á‡∏î‡∏µ/‡πÄ‡∏•‡∏ÇSAP",
              "displayName": "‡∏Ç‡∏≠‡∏á‡∏î‡∏µ/‡πÄ‡∏•‡∏ÇSAP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢/‡πÄ‡∏•‡∏ÇSAP",
              "displayName": "‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢/‡πÄ‡∏•‡∏ÇSAP",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TT No. / PW No.ServeritySource",
              "displayName": "TT No. / PW No.ServeritySource",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CM report",
              "displayName": "CM report",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Admin Name",
              "displayName": "Admin Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Admin Verify Date",
              "displayName": "Admin Verify Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "TT No",
              "displayName": "TT No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Severity",
              "displayName": "Severity",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°",
              "displayName": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "OpenTicketDate",
              "displayName": "OpenTicketDate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ExpectedDate",
              "displayName": "ExpectedDate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "success",
              "displayName": "success",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "response",
              "displayName": "response",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°)",
              "displayName": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "owner",
              "displayName": "owner",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "go_time",
              "displayName": "go_time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "start_time",
              "displayName": "start_time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "done_time",
              "displayName": "done_time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "locationDefine": {
            "values": {}
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1520,
        -208
      ],
      "id": "eea83971-079f-4307-ac10-bc1c1b613ad8",
      "name": "Append row in sheet",
      "retryOnFail": true,
      "waitBetweenTries": 2000,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "WoHKjUMsnt7MqePX",
          "name": "Google Sheets account - UPDATE23-02-2026"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "5babda58-81d0-4a73-8610-6a422d946b38",
              "leftValue": "={{$json.ticket_no}}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1120,
        -128
      ],
      "id": "9410f008-50cd-4580-982c-e6a944840674",
      "name": "If"
    },
    {
      "parameters": {
        "operation": "send",
        "to": "={{ $('Line Messaging Trigger').item.json.source.groupId || $('Line Messaging Trigger').item.json.source.userId }}",
        "messages": {
          "values": [
            {
              "text": "={{\n`‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á ${$('Line Messaging Trigger').item.json.source.userId || \"‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏á‡∏≤‡∏ô\"} ‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤\n\nüìå Ticket: ${$json.ticket_no || '-'}\n‚ö° Severity: ${\n  $json.severity === 'NSA1' ? 'üö®üî¥ NSA1' :\n  $json.severity === 'NSA2' ? '‚ö†Ô∏èüü† NSA2' :\n  $json.severity === 'NSA3' ? '‚ö°üü° NSA3' :\n  $json.severity === 'NSA4' ? 'üü¢üîµ NSA4' :\n  '-'\n}\n\nüìÖ Fault: ${$json.fault_date || '-'}\nüìÜ Expected: ${$json.expected_date || '-'}\nüìÜ Open Ticket Date:  ${$json.openTicket_date || '-'}\n\n\nüöó Go: ${$json.go_time || '-'}\nüîß Start: ${$json.start_time || '-'}\n‚úÖ Done: ${$json.done_time || '-'}\nüìç Status: ${$json.status || '-'}\n`\n}} "
            }
          ]
        }
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        2016,
        -224
      ],
      "id": "7697a638-516b-42e8-8a1c-8c8cfb33e779",
      "name": "Line Messaging",
      "credentials": {
        "lineMessagingApi": {
          "id": "aJgZGG757I8itMKK",
          "name": "Bot-SYS2"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "798c952e-16d5-4a69-bc47-a354bbfc12cf",
              "name": "TT No",
              "value": "={{$json.ticket_no}}",
              "type": "string"
            },
            {
              "id": "52a5d7bd-9cd9-40a0-81d7-75aadaad18cf",
              "name": "Severity",
              "value": "={{ $json.severity }}",
              "type": "string"
            },
            {
              "id": "12152c67-4c01-47e0-897c-f0b89a5ff7da",
              "name": "SLA/TM (‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ä‡∏°)",
              "value": "={{\n  $json.severity === 'NSA1' ? 4 :\n  $json.severity === 'NSA2' ? 8 :\n  $json.severity === 'NSA3' ? 14 :\n  $json.severity === 'NSA4' ? 24 :\n  0\n}}",
              "type": "string"
            },
            {
              "id": "0b0e29d4-e610-4fab-b6af-e408a94c1a98",
              "name": "OpenTicketDate",
              "value": "={{$json.fault_date}}",
              "type": "string"
            },
            {
              "id": "ae3a42a0-1b86-4048-9467-d64427660a44",
              "name": "ExpectedDate",
              "value": "={{\n  (() => {\n    const base = new Date($json.fault_date);\n    const addHours =\n      $json.severity === 'NSA1' ? 4 :\n      $json.severity === 'NSA2' ? 8 :\n      $json.severity === 'NSA3' ? 14 :\n      $json.severity === 'NSA4' ? 24 :\n      0;\n\n    const result = new Date(base.getTime() + addHours * 60 * 60 * 1000);\n\n    return result.toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' });\n  })()\n}}",
              "type": "string"
            },
            {
              "id": "3c74b154-8314-4e96-befd-b185c03d0a7a",
              "name": "owner",
              "value": "={{ $json.owner }}",
              "type": "string"
            },
            {
              "id": "704cfe8b-2997-4868-a5cf-bb8a74312a85",
              "name": "go_time",
              "value": "={{ $json.go_time }}",
              "type": "string"
            },
            {
              "id": "c61c0ad9-8eb6-4e7b-9d42-6bfff8752335",
              "name": "start_time",
              "value": "={{ $json.start_time }}",
              "type": "string"
            },
            {
              "id": "a6168b76-77a9-4feb-b5b4-8945318971e7",
              "name": "done_time",
              "value": "={{ $json.done_time }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1328,
        -144
      ],
      "id": "61331a7a-6298-4fa1-9f5c-44522107a1ad",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "content": "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
        "height": 176,
        "width": 166,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1488,
        -240
      ],
      "typeVersion": 1,
      "id": "c2d04c39-da30-41e1-974d-13127ca95817",
      "name": "Sticky Note12"
    },
    {
      "parameters": {
        "jsCode": "function clean(value) {\n  if (\n    value === undefined ||\n    value === null ||\n    value === \"\" ||\n    value === \"-\" ||\n    value === \"null\"\n  ) {\n    return null;\n  }\n  return value;\n}\n\nreturn items.map(item => {\n\n  const data = item.json;\n\n  const go = clean(data[\"go_time\"]);\n  const start = clean(data[\"start_time\"]);\n  const done = clean(data[\"done_time\"]);\n\n  let status = null;\n\n  if (done) {\n    status = \"Done\";\n  } else if (start) {\n    status = \"In Progress\";\n  } else if (go) {\n    status = \"On Site\";\n  } else {\n    status = \"Open\";\n  }\n\n  return {\n    json: {\n      ticket_no: clean(data[\"TT No\"]),\n      severity: clean(data[\"Severity\"]),\n      openTicket_date: clean(data[\"OpenTicketDate\"]),\n      fault_date: clean(data[\"OpenTicketDate\"]), // ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏û‡∏≠\n      expected_date: clean(data[\"ExpectedDate\"]),\n      owner: clean(data[\"owner\"]),\n      go_time: go,\n      start_time: start,\n      done_time: done,\n      status: status\n    }\n  };\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1744,
        -224
      ],
      "id": "2757ce1c-787c-4127-9722-5c78f7a095fa",
      "name": "Normalize Ticket Data"
    },
    {
      "parameters": {
        "jsCode": "console.log(\"DEBUG DATA:\", $json);\nreturn items;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        272,
        -128
      ],
      "id": "1d63c63c-0584-417c-88f6-137707d2cc7d",
      "name": "Code ViewError"
    },
    {
      "parameters": {
        "operation": "send",
        "to": "={{ \n  $node[\"Line Messaging Trigger\"].json.source.groupId \n  || \n  $node[\"Line Messaging Trigger\"].json.source.userId \n}}",
        "messages": {
          "values": [
            {
              "text": "=‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Ticket ‡πÑ‡∏î‡πâ\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"
            }
          ]
        }
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        1552,
        64
      ],
      "id": "cf5e5a3d-2bc7-48c6-97ce-8d6c2f59874b",
      "name": "Line Messaging3",
      "credentials": {
        "lineMessagingApi": {
          "id": "aJgZGG757I8itMKK",
          "name": "Bot-SYS2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return items.map(item => {\n  if (!item.json.reply || item.json.reply.trim() === \"\") {\n    item.json.reply = \"‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á\";\n  }\n  return item;\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1328,
        64
      ],
      "id": "574b196b-a10b-4fe5-83e1-8971915a8746",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "content": "reply ‡πÇ‡∏î‡∏¢‡∏≠‡∏¥‡∏á userId / GroupId",
        "width": 246,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1984,
        -272
      ],
      "typeVersion": 1,
      "id": "83f50d75-0685-4fc4-a62e-064bb5f17eae",
      "name": "Sticky Note13"
    },
    {
      "parameters": {
        "content": "2Ô∏è‚É£ Detect Mode\n‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£\nMode ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ\nupdate_ticket\nquery_ticket\ntoday_summary\nquery_site\nunknown",
        "height": 176,
        "width": 198
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -752,
        -528
      ],
      "typeVersion": 1,
      "id": "f08ac93a-7583-4a08-9cf3-0eed2de124cc",
      "name": "Sticky Note14"
    },
    {
      "parameters": {
        "content": "4Ô∏è‚É£ Parse JSON\n‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤:\nJSON ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\nKey ‡∏Ñ‡∏£‡∏ö\n‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö ‚Üí ‡πÅ‡∏à‡πâ‡∏á Error",
        "height": 128,
        "width": 176
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -224,
        -528
      ],
      "typeVersion": 1,
      "id": "9e4b6720-3a23-4c9e-83cc-38a3ac1aa5f9",
      "name": "Sticky Note15"
    },
    {
      "parameters": {
        "content": "6Ô∏è‚É£ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Google Sheet\n\n‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Ticket ‡∏•‡∏á Sheet ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥",
        "height": 240,
        "width": 256
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        208,
        -528
      ],
      "typeVersion": 1,
      "id": "aff9bf00-e111-41cd-8d25-da6643790ef8",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "‡πÉ‡∏ä‡πâ ‚Äú‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‚Äù ‡∏ó‡∏µ‡πà AI Agent ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô string ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô",
        "height": 176,
        "width": 208
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        64,
        -272
      ],
      "typeVersion": 1,
      "id": "25cb4016-f821-498d-9cbe-d2e8c9684141",
      "name": "Sticky Note16"
    },
    {
      "parameters": {
        "content": "‡πÄ‡πÄ‡∏à‡πâ‡∏á errror",
        "width": 150,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1520,
        32
      ],
      "typeVersion": 1,
      "id": "ade5d5e1-ab63-4750-a836-b9ba73a0b1aa",
      "name": "Sticky Note17"
    },
    {
      "parameters": {
        "content": "# üöÄ Ticket Automation Workflow\n\n## 1) LINE Trigger\n- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Private Chat ‡πÅ‡∏•‡∏∞ Group\n- ‡πÉ‡∏ä‡πâ userId / groupId ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n- Trigger ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ message event\n\n## 2) Mode Detection\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤ TT\\d+\n- ‡πÅ‡∏¢‡∏Å‡πÇ‡∏´‡∏°‡∏î:\n  - update_ticket\n  - query_ticket\n  - today_summary\n  - query_site\n\n## 3) AI Parsing (Gemini)\n- ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô Flat JSON ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô\n- ‡∏´‡πâ‡∏≤‡∏°‡∏°‡∏µ Markdown / ‡∏´‡πâ‡∏≤‡∏°‡∏°‡∏µ Text ‡πÄ‡∏Å‡∏¥‡∏ô\n- ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ null ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\n- Regex ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:\n  - TT\\d+\n  - NSA1‚ÄìNSA4\n  - !Go#HH:mm\n  - !Star#HH:mm\n  - !Done#HH:mm\n\n## 4) JSON Validation\n- Parse string ‚Üí JSON\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏£‡∏ö 9 fields:\n  - ticket_no\n  - severity\n  - fault_date\n  - expected_date\n  - owner\n  - go_time\n  - start_time\n  - done_time\n  - status\n- ‡∏ñ‡πâ‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏¥‡∏î ‚Üí ‡∏™‡πà‡∏á Error ‡∏Å‡∏•‡∏±‡∏ö LINE\n\n## 5) SLA Calculation\n- NSA1 = 4 ‡∏ä‡∏°.\n- NSA2 = 8 ‡∏ä‡∏°.\n- NSA3 = 14 ‡∏ä‡∏°.\n- NSA4 = 24 ‡∏ä‡∏°.\n- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ExpectedDate ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Asia/Bangkok)\n\n## 6) Auto Status Logic\n- done_time ‚Üí Done\n- start_time ‚Üí In Progress\n- go_time ‚Üí On Site\n- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤ ‚Üí Open\n\n## 7) Google Sheets Integration\n- Append Row\n- Auto Retry ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Fail\n- ‡∏ñ‡πâ‡∏≤ Error ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö LINE\n\n## 8) LINE Summary Response\n‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•:\n- Ticket No\n- Severity (‡∏û‡∏£‡πâ‡∏≠‡∏° Emoji)\n- Fault Date\n- Expected Date\n- Go / Start / Done\n- Status",
        "height": 1680,
        "width": 960,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2400,
        -352
      ],
      "typeVersion": 1,
      "id": "b5db10f0-6969-44cf-ac75-79322dd7d155",
      "name": "Sticky Note18"
    },
    {
      "parameters": {
        "operation": "send",
        "to": "={{$node[\"Line Messaging Trigger\"].json.source.groupId || $node[\"Line Messaging Trigger\"].json.source.userId}}",
        "messages": {
          "values": [
            {
              "quoteToken": "=    {\n      \"text\": \"‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á\"\n    }\n  ]\n}",
              "text": "‚ö†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Ticket ‡πÑ‡∏î‡πâ\n\n‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:\n{{$json.message || \"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\"}}\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"
            }
          ]
        }
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        1696,
        -80
      ],
      "id": "3320e5be-33c8-4ab7-847b-1edb23522487",
      "name": "Line Messaging SendError",
      "credentials": {
        "lineMessagingApi": {
          "id": "T6r34cSYwbockIDL",
          "name": "SYS-Report1"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "AI Agent": {
      "main": [
        [
          {
            "node": "Merge User",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Line Messaging Trigger": {
      "main": [
        [
          {
            "node": "Detect Mode",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        []
      ]
    },
    "Tools Sheet": {
      "ai_tool": [
        []
      ]
    },
    "Detect Mode": {
      "main": [
        [
          {
            "node": "Code ViewError",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF - Query Mode": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Merge User": {
      "main": [
        [
          {
            "node": "Parse Final JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Final JSON": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in Google Sheets": {
      "ai_tool": [
        []
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Line Messaging": {
      "main": [
        []
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Normalize Ticket Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Line Messaging SendError",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Normalize Ticket Data": {
      "main": [
        [
          {
            "node": "Line Messaging",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code ViewError": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Line Messaging3": {
      "main": [
        []
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Line Messaging3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "binaryMode": "separate",
    "availableInMCP": false,
    "timeSavedMode": "dynamic",
    "timezone": "Asia/Bangkok",
    "saveExecutionProgress": true,
    "callerPolicy": "workflowsFromSameOwner",
    "executionTimeout": 20
  },
  "versionId": "d2c835df-7d55-4057-b6c7-0b69fd7345ae",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "05944909a8ccb3ffdf59c45978efdd311c90ab3658ab8e0fd81f135870dfea78"
  },
  "id": "eBWvIYsLeHOdknvh",
  "tags": []
}